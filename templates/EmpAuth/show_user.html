{% extends 'EmpAuth/user.html' %}
{#{% block title %}{% endblock %}#}
{#{% block main %}#}
{#            <div class="tab-content">#}
{#                <div class="tab-pane fade in active">#}
{#                    <div class="row">#}
{#                                <div class="panel-heading" style="background-color: white">#}
{#                                    <B class="fa fa-th"> 用户信息表</B><div style="float: right;"><a href="#" class="fa fa-hand-o-right">详细信息</a></div>#}
{#                                </div>#}
{#                                <div class="panel-body">#}
{#                                    <div class="dataTable_wrapper">#}
{#                                        <table class="table table-striped table-bordered table-hover" id="dataTables-example">#}
{#                                            <thead>#}
{#                                                <tr>#}
{#                                                    <th>序号</th>#}
{#                                                    <th>用户</th>#}
{#                                                    <th>密码</th>#}
{#                                                    <th>备注</th>#}
{#                                                    <th>管理</th>#}
{#                                                </tr>#}
{#                                            </thead>#}
{#                                            <tbody>#}
{#                                                {% for i in a %}#}
{#                                                <tr class="gradeA">#}
{#                                                    <td>{{ i.id }}</td>#}
{#                                                    <td>{{ i.username }}</td>#}
{#                                                    <td>{{ i.password }}</td>#}
{#                                                    <td class="center">{{ i.note }}</td>#}
{#                                                    <td><a href="/EmpAuth/change/?username={{ i.username }}"><button class="btn btn-warning btn-xs" type="button">修改密码</button></a> <a href="/EmpAuth/userdel/?username={{ i.username }}"><button class="btn btn-danger btn-xs" type="button">删除</button></a></td>#}
{#                                                </tr>#}
{#                                            {% endfor %}#}
{#                                            </tbody>#}
{#                                        </table>#}
{#                                    </div>#}
{#                                </div>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#{% endblock %}#}

{% block main %}
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="ibox float-e-margins">
            <div class="ibox-content">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>用户名</th>
                            <th>姓名</th>
                            <th>部门</th>
                            <th>用户id</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    {% for i in user_list %}
                        <tbody>
                            <tr>
                                <td>{{ i.username }}</td>
                                <td>{{ i.first_name }}</td>
                                <td>
                                    {% if i.department %}
                                    {{ i.department }}
                                    {% endif %}
                                </td>
                                <td>{{ i.id| add:30000 }}</td>
                                <td>
                                    {% if i.is_active  and i.is_staff%}
                                        <i class="fa fa-check-circle-o" style="color:#279048">正常</i>
                                    {% elif not i.is_staff and i.is_active%}
                                        <i class="fa fa-ban">禁用</i>
                                    {% else %}
                                        <i class="fa fa-ban">离职</i>
                                    {% endif %}</td>
                                <td>
                                    {% if request.user.is_superuser or request.session.fun_auth.edit_user %}
                                    <a href="/accounts/user_edit/{{ i.id }}/" class="btn btn-xs btn-info">修改</a>
                                    {% if not i.is_staff and i.is_active %}
                                        <a href="/accounts/status/{{ i.id }}/" class="btn btn-success btn-xs status"></i>恢复</a>
                                    {% else %}
                                         <a href="/accounts/status/{{ i.id }}/" class="btn btn-xs btn-warning status"></i>禁用</a>
                                        {% endif %}
                                    <a href="/accounts/delete/{{ i.id }}/" class="btn btn-xs btn-danger status">删除</a>
                                    {% endif %}
                                </td>
                            </tr>
                        </tbody>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
</div>
<script>
$(function() {
    $(document).on("click", ".status", function (e) {
        e.preventDefault();
        var url = $(this).attr("href");
        $.ajax({
            type: "GET",
            url: url
        }).done(function (data) {
            window.location.reload();
        });
        return false;
    });
})
</script>
    <script type="text/javascript">
    var two = document.location.pathname.split("/")[2];
    $("." + two).addClass('active');
</script>
{% endblock main %}